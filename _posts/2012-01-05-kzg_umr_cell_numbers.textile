---
layout: report
title: Analysis of Expression Level Changes from Increasing RNA Staring Amounts
analyst: jfv
researcher: kzg 
pi: molbio
data:
- data/kzg_umr_cell_numbers/
categories: 
- molbio
---

h2. Objective

RNA-seq data has been generated from libraries constructed with variable amounts of starting RNA: 10ng, 100ng, and 1000ng (1ug) were used to construct 3 libraries. These libraries were sequenced on two lanes each to increase the number of reads for each sample. This analysis looks at how similar expression values are for data generated from these various starting amounts.

h2. Data

h3. Data Sources

Single-end data was supplied for 2 samples of each of the 3 libraries. The original paths to the RNA-seq fastq files generated from these samples are listed below:

{% table tsv %}
Path	Sample
/n/analysis/Li_Linheng/rsu/Li_Linheng-2011-07-12/64E53AAXX/s_2_1_ACAGTG.fastq.gz	UMR_10ng_1
/n/analysis/Li_Linheng/rsu/Li_Linheng-2011-07-12/64E53AAXX/s_3_1_CTTGTA.fastq.gz	UMR_10ng_2
/n/analysis/Li_Linheng/rsu/Li_Linheng-2011-07-12/64E53AAXX/s_2_1_TGACCA.fastq.gz	UMR_100ng_1
/n/analysis/Li_Linheng/rsu/Li_Linheng-2011-07-12/64E53AAXX/s_3_1_CAGATC.fastq.gz	UMR_100ng_2
/n/analysis/Li_Linheng/rsu/Li_Linheng-2011-07-12/64E53AAXX/s_4_1_ACTTGA.fastq.gz	UMR_1ug_1
/n/analysis/Li_Linheng/rsu/Li_Linheng-2011-07-12/64E5NAAXX/s_4_1_ACTTGA.fastq.gz	UMR_1ug_2
{% endtable %}

h3. Data Quality

The quality of the raw sequence data was analyzed to check if any alteration of the data needed to be done before continuing with downstream analysis.

Fastqc was used for a more in-depth look at the quality of the sequence data.  The two sets of samples for each library were run on separate flowcells. All three samples from the two flowcells were run on the same lane, using TruSeq indexes to distinguish between samples. While quality drops slightly towards the end of the run, the overall quality of the samples were satisfactory. Trimming was not performed on the reads and all 45 reads were used for all samples. Here is an example graph from Fastqc that shows the quality for one of these samples

!(large)data/kzg_umr_cell_numbers/fastqc_results.png!

h3. Read Data

The sequencing process indicates the percentage of reads that are of sufficient quality to pass the on-device quality thresholds. This data is provided below:

{% table tsv %}
Sample Name	% Pass Filter	Total # Reads	# Reads (PF)
UMR_10ng_1	82.17	13,047,104	10,720,805 
UMR_10ng_2	80.87	11,953,926	9,667,140 
UMR_100ng_1	84.42	11,683,066	9,862,844 
UMR_100ng_2	83.6	10,385,444	8,682,231 
UMR_1ug_1	87.04	10,926,455	9,510,386 
UMR_1ug_2	86.81	9,712,140	8,431,109 
{% endtable %}

We can see that all samples have a relatively high percentage of reads that pass filter. Pass filter percentages are higher for the two UMR_1ug samples, but they have fewer overall total reads than the other samples, thus the number of reads that pass filter for these samples are roughly equivalent to UMR_100ng, which are both less than UMR_10ng.

h3. Alignment Data

Statistics were also generated for the quality of the alignment process. Alignment was performed using tophat (described below).  For each sample, the total number of unique reads in the aligned bam files created by tophat is provided as well as corresponding percentage of the raw reads that were aligned. Multireads are defined as those reads that align to multiple locations on the genome.

{% table tsv %}
Sample Name	# Unique Aligned Reads	% Unique Reads Aligned	# MultiReads	Total # Reads Aligned
UMR_10ng_1	8,746,704 	81.59 	3,976,390 	12,723,094 
UMR_10ng_2	7,840,386 	81.10 	3,568,632 	11,409,018 
UMR_100ng_1	8,930,236 	90.54 	3,594,396 	12,524,632 
UMR_100ng_2	7,831,761 	90.20 	3,150,524 	10,982,285 
UMR_1ug_1	8,718,376 	91.67 	3,346,778 	12,065,154 
UMR_1ug_2	7,708,547 	91.43 	2,962,687 	10,671,234 
{% endtable %}

We can see from this data that tophat did a sufficient job at aligning all samples. The UMR_100ng and UMR_1ug samples have a significantly higher percentage of unique reads from the fastq files aligning in the bam files.

h2. Methods

Sequences for each sample were first aligned using tophat (v1.3.1). The reference genome and annotation files used for the alignment were from the UCSC mm9 genome and the ensemble build 63.  The output of the alignment process was a bam file for each sample. The sample bam files for each library were then merged using samtools. These merged bam files were used for the rest of the downstream analysis. Further processing was not performed to ensure a complete look at the dataset.

Expression levels for genes found in the aligned datasets were found using cufflinks(v1.0.3). The input to cufflinks is the bam files created by tophat. Cufflinks outputs RPKM values for genes in the sequence data. Further analysis of this RPKM data was performed using custom R scripts.

Coverage data for the aligned reads of the samples was also generated as a way to compare datasets. BEDTools(v2.12.0) was used to acquire this data. Specifically, the coverageBed tool was used to find coverage information for each exon in the bam files. This allows us to see the coverage on only the relevant portions of the genome and exclude reads aligned to intronic regions of genes that would most likely be invalid.


h2. Results

h3. IGV Session

An IGV session is available at the link below, which provides visualization of the bam files. Session was created using IGV 2.0.5.

{% file_links /n/facility/Bioinformatics/analysis/MolBio/kzg/umr_2011_07_12/igv_session.xml %}

h3. Coverage

First, we look at the level of coverage for exon and genes in the samples. We define an exon as being covered if a certain number of the bases of that exon have one or more reads aligned to them. For this analysis, a covered exon is one with one or more reads aligned to over 10% of the total number of bases in the exon. This metric was chosen to try to give a level of confidence that a covered exon is one with a significant / useful number of genes mapped to it. The plot below shows the percentage of the total number of exons that are covered by each sample.

!(medium)data/kzg_umr_cell_numbers/percent_exons_covered.png!

{% table tsv %}
UMR_10ng	UMR_100ng	UMR_1ug
54.58%	60.27%	60.67%
{% endtable %}

There are around 245,000 exons annotated in the genome used. Of these all these possible exons, we see that the two larger samples, UMR_100ng and UMR_1ug both cover around 60%. The smallest sample has less total coverage, at around 54%.

To see if there were specific areas contributing more to the lower exon coverage, this coverage data was split up between chromosomes. The graphs below show total numbers and percentages of exons covered per sample by each chromosome. 

!(large)data/kzg_umr_cell_numbers/number_exons_covered.png!

!(large)data/kzg_umr_cell_numbers/percent_all_exons_covered.png!

Again, the trend is that UMR_100ng and UMR_1ug are similar in their coverage and both somewhat greater than UMR_10ng.

We can combine exon coverage to show the number of genes covered by each sample, to see this data at a higher level. Below is a graph of genes covered by sample. Gene coverage is defined as having at least one of the genes exons covered by the data. We can see that at this level, there is little variation as to the total number of genes each sample covers, however the two larger samples cover more genes.


h3. Expression Data

The output data from cufflinks provides RPKM values for each of the samples at a per-gene level. First, we looked at the number of genes in each sample that are found to be expressed at some level. Below are two charts providing both total number and percentage of all genes found to be expressed in the various samples. 
 
h3. Uniquely Expressed Genes

There were 1,343 genes found only to be expressed in the UMR_1ug samples. A table with these genes as well as their biotypes and descriptions can be found here:

{% file_links /n/facility/Bioinformatics/analysis/MolBio/kzg/umr_2011_07_12/genes_only_expressed_in_UMR_1ug_info_and_expression.csv %}

Concerning the other samples, 626 genes were found to only have expression values for UMR_10ng and 1,213 were only found in UMR_100ng.

h3. Correlation of Expression Values

Next, we looked at the correlation between the expression values for the various samples. Initially, looking at raw expression values, we can see that all three samples are fairly highly correlated.


!(medium)data/kzg_umr_cell_numbers/correlation_plot_samples.png!

{% table tsv %}
	UMR_10ng	UMR_100ng	UMR_1ug
UMR_10ng	100%	97%	82%
UMR_100ng	97%	100%	92%
UMR_1ug	82%	92%	100%
{% endtable %}

We can also look at the correlation of the log of the expression values. Below is a correlation matrix that compares log2 expression values between cell numbers. Note the differences in the color scale. 


!(medium)data/kzg_umr_cell_numbers/correlation_plot_log2_samples.png!

{% table tsv %}
	UMR_10ng	UMR_100ng	UMR_1ug
UMR_10ng	100%	88%	88%
UMR_100ng	88%	100%	89%
UMR_1ug	88%	89%	100%
{% endtable %}

An MA Plot can be used to show the spread of the data as well. The y-axis in this graph shows the mean values for each element in the two datasets. The x-axis gives the difference between the two values for each point. Log2 MA Plots are given comparing both UMR_10ng and UMR_100ng to UMR_1ug:


!(medium)data/kzg_umr_cell_numbers/lsk_maplot_umr_10ng_umr_1ug.png!

!(medium)data/kzg_umr_cell_numbers/lsk_maplot_umr_100ng_umr_1ug.png!

We can also plot the log2 expression values for each gene against one another for each sample:
 
!(large)data/kzg_umr_cell_numbers/samples_log_expression_values_scatter.png!

With a closer look at UMR_10ng and UMR_100ng vs UMR_1ug:


!(medium)data/kzg_umr_cell_numbers/samples_log_expression_values_scatter_umr_10ng_umr_1ug.png!

